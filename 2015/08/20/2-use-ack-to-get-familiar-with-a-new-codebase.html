<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>#2: Use Ack to Get Familiar With a New Codebase</title>
  <meta name="description" content="ack is an incredibly useful tool when approaching a new codebase, especially if you’re focused on a specific feature. It allows you to quickly get a view of ...">

  <link rel="stylesheet" href="/cli_blog/css/main.css">
  <link rel="canonical" href="http://benmccormick.github.io/cli_blog/2015/08/20/2-use-ack-to-get-familiar-with-a-new-codebase.html">
  <link rel="alternate" type="application/rss+xml" title="Command Line Tips" href="http://benmccormick.github.io/cli_blog/feed.xml" />
  <link href='/cli_blog/stylesheets/all-df3bc31acdc5a4d8469c13e0869847e0.css' media='all' rel='stylesheet' type='text/css'>

</head>

  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/cli_blog/">Command Line Tips</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/cli_blog/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">#2: Use Ack to Get Familiar With a New Codebase</h1>
    <p class="post-meta">Aug 20, 2015</p>
  </header>

  <article class="post-content">
    <p><a href="http://beyondgrep.com/">ack</a> is an incredibly useful tool when approaching a new codebase, especially if you’re focused on a specific feature. It allows you to quickly get a view of the codebase, and then zero in on the functionality you’re interested in.  To see how this works, let’s use jQuery’s <a href="https://github.com/jquery/jquery">source repo</a> as an example, and see what happens if we want to get a look at how it implements ajax.</p>

<figure class="code-highlight-figure"><figcaption class="code-highlight-caption"><span class="code-highlight-caption-title">get jQuery</span></figcaption><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ git clone git@github.com:jquery/jquery.git
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">❯ <span class="nb">cd </span>jquery</div></div></pre></div></figure>

<p>We can start by trying to get a general idea of the size of the codebase.  Running <code>ack -f</code> to show all files in the directory will immediately overrun our terminal, so we can get a file count using <code>wc</code> instead</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack -f <span class="p">|</span>wc -l
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    249</div></div></pre></div></figure>

<p>Ok thats a good amount of files.  But how many of them are actually source files?  We can filter down to just the javascript files.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack -f --js <span class="p">|</span>wc -l
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    155</div></div></pre></div></figure>

<p>But thats probably still a bit high, since not all of the JavaScript files are source files.  A quick <code>ls</code> shows that we probably want to filter down to the src directory.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack -f --js src <span class="p">|</span>wc -l
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    92</div></div></pre></div></figure>

<p>Ok so now we’re down to 92 source files.  Still a bit much, but its probably worth printing them with <code>ack -f --js src</code> at this point to get an idea of the directory structure.  When we do that, we can see there’s an ajax folder, which is probably what we’re interested in.  To make sure we’re not missing related files, we can continue on to searching for files with ajax in the file name directly.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack -g --js ajax src
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/jsonp.js
</div></div><div data-line="3" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/load.js
</div></div><div data-line="4" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/parseJSON.js
</div></div><div data-line="5" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/parseXML.js
</div></div><div data-line="6" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/script.js
</div></div><div data-line="7" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/var/location.js
</div></div><div data-line="8" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/var/nonce.js
</div></div><div data-line="9" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/var/rquery.js
</div></div><div data-line="10" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/xhr.js
</div></div><div data-line="11" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax.js
</div></div><div data-line="12" class="code-highlight-row numbered"><div class="code-highlight-line">    src/event/ajax.js</div></div></pre></div></figure>

<p>That gets us down to 11 files to look at.  But we might be getting a bit greedy.  Not every file related to ajax may have ajax in the file path.  We can use the <code>-l</code> option of ack to display the list of files that contain ack somewhere in their text.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack --js -l ajax src
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/jsonp.js
</div></div><div data-line="3" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/load.js
</div></div><div data-line="4" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/script.js
</div></div><div data-line="5" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax/xhr.js
</div></div><div data-line="6" class="code-highlight-row numbered"><div class="code-highlight-line">    src/ajax.js
</div></div><div data-line="7" class="code-highlight-row numbered"><div class="code-highlight-line">    src/event/ajax.js
</div></div><div data-line="8" class="code-highlight-row numbered"><div class="code-highlight-line">    src/jquery.js
</div></div><div data-line="9" class="code-highlight-row numbered"><div class="code-highlight-line">    src/manipulation/_evalUrl.js
</div></div><div data-line="10" class="code-highlight-row numbered"><div class="code-highlight-line">    src/serialize.js</div></div></pre></div></figure>

<p>Ok that adds 3 additional files with ajax references.  But its not clear that they’re relevant to jQuery’s ajax implementation, it may just be a file reference or comment.  Lets use ack to get a quick look at how ajax is referenced in those files.  This part gets a bit more complicated.  We can use ack’s <code>-v</code> option to invert our matching and find non-matching inputs, then use unix piping to filter our previous command.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack --js -l ajax src <span class="p">|</span>ack -v ajax
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line">    src/jquery.js
</div></div><div data-line="3" class="code-highlight-row numbered"><div class="code-highlight-line">    src/manipulation/_evalUrl.js
</div></div><div data-line="4" class="code-highlight-row numbered"><div class="code-highlight-line">    src/serialize.js</div></div></pre></div></figure>

<p>Now we can use ack’s <code>-x</code> argument to search the files piped in through standard input.</p>

<figure class="code-highlight-figure"><div class="code-highlight"><pre class="code-highlight-pre"><div data-line="1" class="code-highlight-row numbered"><div class="code-highlight-line">❯ ack --js -l ajax src <span class="p">|</span>ack -v ajax<span class="p">|</span>ack -x ajax
</div></div><div data-line="2" class="code-highlight-row numbered"><div class="code-highlight-line"> </div></div><div data-line="3" class="code-highlight-row numbered"><div class="code-highlight-line">    src/jquery.js
</div></div><div data-line="4" class="code-highlight-row numbered"><div class="code-highlight-line">    20:     <span class="s2">&quot;./ajax&quot;</span>,
</div></div><div data-line="5" class="code-highlight-row numbered"><div class="code-highlight-line">    21:     <span class="s2">&quot;./ajax/xhr&quot;</span>,
</div></div><div data-line="6" class="code-highlight-row numbered"><div class="code-highlight-line">    22:     <span class="s2">&quot;./ajax/script&quot;</span>,
</div></div><div data-line="7" class="code-highlight-row numbered"><div class="code-highlight-line">    23:     <span class="s2">&quot;./ajax/jsonp&quot;</span>,
</div></div><div data-line="8" class="code-highlight-row numbered"><div class="code-highlight-line">    24:     <span class="s2">&quot;./ajax/load&quot;</span>,
</div></div><div data-line="9" class="code-highlight-row numbered"><div class="code-highlight-line">    25:     <span class="s2">&quot;./event/ajax&quot;</span>,
</div></div><div data-line="10" class="code-highlight-row numbered"><div class="code-highlight-line"> </div></div><div data-line="11" class="code-highlight-row numbered"><div class="code-highlight-line">    src/manipulation/_evalUrl.js
</div></div><div data-line="12" class="code-highlight-row numbered"><div class="code-highlight-line">    2:      <span class="s2">&quot;../ajax&quot;</span>
</div></div><div data-line="13" class="code-highlight-row numbered"><div class="code-highlight-line">    6:      <span class="k">return</span> jQuery.ajax<span class="o">(&#x7b;</span>
</div></div><div data-line="14" class="code-highlight-row numbered"><div class="code-highlight-line">    9:              // Make this explicit, since user can override this through ajaxSetup <span class="o">(</span><span class="c">#11264)</span>
</div></div><div data-line="15" class="code-highlight-row numbered"><div class="code-highlight-line"> </div></div><div data-line="16" class="code-highlight-row numbered"><div class="code-highlight-line">    src/serialize.js
</div></div><div data-line="17" class="code-highlight-row numbered"><div class="code-highlight-line">    61:             <span class="nv">traditional</span> <span class="o">=</span> jQuery.ajaxSettings <span class="o">&amp;&amp;</span> jQuery.ajaxSettings.traditional<span class="p">;</span></div></div></pre></div></figure>

<p>So we can see pretty quickly that these files are safe to ignore in terms of understanding how ajax works in jQuery.  They’re just module loads, an actual call to the ajax method for other purposes, and settings serialization. It is useful to note that <code>src/ajax</code> is loaded into the main jQuery file first. Its probably worth looking at it as the starting point for our investigation. We’re well on our way to diving into the ajax functionality, able to focus on 11 of the 249 files in the repo immediately, already knowing how those files are loaded into the main library.</p>

<p>This was just a simple example.  Whenever you’re spelunking into new code territory, consider using ack to get your bearings.  Things go a lot faster when you know the lay of the land in advance.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

      <!--   <h2 class="footer-heading">Command Line Tips</h2> --!>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Command Line Tips</li>
          <li><a href="mailto:ben@benmccormick.org">ben@benmccormick.org</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/benmccormick">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">benmccormick</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/ben336">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">ben336</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Command Line Tips from Ben McCormick.  Short practical snippets from day to day practice.
</p>
      </div>
    </div>

  </div>

</footer>

  </body>

</html>
